# 📋 기능 명세서 (SPEC.md)

## 1. 프로젝트 개요

### 목적
엑셀/CSV 업로드 없이 웹 화면에서 수입/지출 내역을 직접 입력하고, 저장/조회/수정/삭제할 수 있으며, 입력된 데이터를 기반으로 소비패턴을 자동 분석(요약 지표 + 차트 + 인사이트)하는 개인 가계부 웹 애플리케이션.

### 대상 사용자
- 개인 재무 관리를 원하는 일반 사용자
- 엑셀 없이 간편하게 가계부를 쓰고 싶은 사용자
- 소비 습관을 시각적으로 파악하고 싶은 사용자

---

## 2. 주요 기능 목록

### 2.1 🏠 대시보드 (Home / app.py)
| 기능 | 설명 |
|------|------|
| 요약 카드 | 총 수입, 총 지출, 순수익, 일평균 지출 표시 |
| 지출 TOP 카테고리 | 상위 3개 카테고리와 비율 표시 |
| 지출 추이 차트 | 날짜별 지출 라인 차트 (plotly) |
| 카테고리 비중 차트 | 도넛 차트로 카테고리별 비율 표시 |
| 월별 비교 차트 | 수입/지출 월별 비교 바 차트 |
| 인사이트 | 규칙 기반 자동 분석 결과 표시 |
| 빈 상태 안내 | 데이터 없을 때 친절한 안내 메시지 |

### 2.2 📝 입력 (거래 등록)
| 기능 | 설명 |
|------|------|
| 거래 폼 | 날짜, 유형, 금액, 카테고리, 결제수단, 메모 입력 |
| 입력 검증 | 금액 양수 필수, 카테고리 필수 |
| 저장 확인 | 저장 성공 시 요약 테이블 표시 |
| 최근 내역 | 최근 5건 거래 미리보기 |

### 2.3 📋 내역 (거래 목록/관리)
| 기능 | 설명 |
|------|------|
| 기간 필터 | 이번 달 / 지난 달 / 최근 3개월 / 전체 / 사용자 지정 |
| 타입 필터 | 전체 / 수입 / 지출 |
| 카테고리 필터 | 멀티 선택 가능 |
| 결제수단 필터 | 현금/카드/이체/기타 |
| 메모 검색 | 키워드 기반 검색 |
| 정렬 | 날짜순 / 금액순, 오름차순/내림차순 |
| 수정 기능 | 선택 후 폼에서 수정 및 저장 |
| 삭제 기능 | 체크박스 확인 후 삭제 (실수 방지) |

### 2.4 📊 분석 (소비패턴 리포트)
| 기능 | 설명 |
|------|------|
| 요약 카드 | 기간 내 총 수입/지출/순수익/일평균지출 |
| 지출 추이 | 날짜별 라인 차트 |
| 카테고리 비중 | 도넛/파이 차트 |
| 카테고리 금액 | 바 차트 |
| 결제수단별 | 바 차트 |
| 요일별 분석 | 평균 지출 바 차트 |
| 월별 비교 | 수입/지출 그룹 바 차트 |
| 예산 현황 | 프로그레스 바 + 경고 배지 |
| 인사이트 | 규칙 기반 자동 분석 (아래 상세) |

### 2.5 ⚙️ 설정
| 기능 | 설명 |
|------|------|
| 카테고리 관리 | 수입/지출 카테고리 추가/삭제 |
| 예산 설정 | 월별 전체/카테고리별 예산 CRUD |
| CSV 내보내기 | UTF-8-sig 인코딩 한글 CSV 다운로드 |
| 데이터 초기화 | 거래만 삭제 또는 전체 초기화 (확인 입력 필요) |
| 샘플 데이터 | 데모용 1~6개월치 자동 생성 |

---

## 3. 사용자 입력 항목 및 유효성 검증

| 필드 | 타입 | 필수 | 검증 규칙 |
|------|------|------|-----------|
| 날짜 | date_input | ✅ | 기본값: 오늘 |
| 유형 | radio (수입/지출) | ✅ | 기본값: 지출 |
| 금액 | number_input | ✅ | 0보다 큰 정수, 최대 1억 |
| 카테고리 | selectbox | ✅ | 유형에 따라 다른 목록 |
| 결제수단 | selectbox | ❌ | 기본값: 카드 |
| 메모 | text_input | ❌ | 빈 문자열 허용 |

---

## 4. 데이터 처리 방식

### DB 스키마
- **transactions**: id, date, type, amount, category, payment_method, memo, created_at
- **categories**: id, type, name (UNIQUE(type, name))
- **budgets**: id, month, category, budget_amount (UNIQUE(month, category))

### 저장 방식
- SQLite 로컬 파일 (budget.db)
- PRAGMA journal_mode=WAL 적용 (동시 접근 성능)
- ON CONFLICT 구문으로 예산 중복 처리

---

## 5. 인사이트 규칙 (LLM 없이 규칙 기반)

| 인사이트 | 조건 | 유형 |
|----------|------|------|
| 지출 상위 카테고리 | 항상 (데이터 있을 때) | info |
| 전월 대비 증감 | 2개월 이상 데이터 | warning/success/info |
| 예산 초과 경고 | 예산 설정 + 80%/100% 초과 | warning |
| 이상치 탐지 | 평균+2σ 초과 지출 | info |
| 반복 지출 감지 | 같은 카테고리, ±20% 금액, 25~35일 간격 | info |
| 저축률 안내 | 수입/지출 모두 있을 때 | success/info/warning |

---

## 6. 예외 처리

| 상황 | 처리 |
|------|------|
| DB 파일 없음 | 자동 생성 (init_db) |
| 카테고리 비어있음 | 기본 카테고리 자동 삽입 |
| 데이터 없음 | 친절한 빈 상태(empty state) 표시 |
| 금액 0 이하 입력 | 에러 메시지 표시, 저장 차단 |
| 카테고리 중복 추가 | UNIQUE 제약 + 워닝 메시지 |
| 삭제 시 실수 방지 | 체크박스 확인 또는 텍스트 입력 필요 |
| 차트 데이터 부족 | 빈 차트 + 안내 메시지 표시 |

---

## 7. 배포 환경 요구사항

| 항목 | 요구사항 |
|------|----------|
| Python | 3.11.x 또는 3.12.x |
| 필수 패키지 | streamlit>=1.54, pandas>=2.0, plotly>=5.18 |
| 데이터베이스 | SQLite 3 (Python 기본 내장) |
| 배포 대상 | Streamlit Cloud, 로컬 실행 |
| 브라우저 | Chrome/Edge/Firefox 최신 버전 |

---

## 8. 스크린샷

> 📸 추후 각 페이지 스크린샷을 이 섹션에 추가할 예정입니다.
>
> - [ ] 대시보드 스크린샷
> - [ ] 입력 페이지 스크린샷
> - [ ] 내역 페이지 스크린샷
> - [ ] 분석 페이지 스크린샷
> - [ ] 설정 페이지 스크린샷
